<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    var event = (function() {
      eventObj = {};

      return {
        //  注册事件 可以连续注册 可以注册多个事件
        on: function(type, handler) {
          (eventObj[type] || (eventObj[type] = [])).push(handler);
        },
        /**
         *  移除事件：
         * -  如果没有参数，移除所有事件
         * -  如果只带有 事件名 参数，就移除这个事件名下的所有事件
         * -  如果带有 两个 参数，那么就是表示移除某一个事件的具体处理函数
         */
        off: function(type, handler) {
          if (arguments.length === 0) {
            eventObj = {};
          } else if (arguments.length === 1) {
            eventObj[type] = [];
          } else if (arguments.length === 2) {
            let _events = eventObj[type];
            if (!_events) return;
            //  倒着循环 数组的 序号不会受到影响
            for (let i = _events.length - 1; i >= 0; i --) {
              if (_events[i] === handler) {
                _events.splice(i, 1);
              }
            }
          }
        },
        //  发射事件，触发事件，包装参数 传递给事件处理函数
        emit: function(type) {
          //  arguments 类数组
          //  Array.from
          let args = Array.prototype.slice.call(arguments, 1);
          let _events = eventObj[type];
          if (!_events) return;
          for(let i = 0; i < _events.length; i ++) {
            _events[i].apply(null, args);
          }
        },
      }
    })();
  </script>
</body>
</html>